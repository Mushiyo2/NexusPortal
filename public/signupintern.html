<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style/signupintern.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inria+Sans:wght@400&display=swap"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@500&display=swap" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&display=swap" rel="stylesheet">
    <title>Intern Portal Signup</title>
</head>
<style>
    .upload-container {
    position: relative;
}

.upload-wrapper {
    position: relative;
    display: flex;
    align-items: center;
}

.form-control {
    width: 100%;
    padding-right: 50px; /* Reserve space for the icon */
}

.upload-icon {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    background-color: #68a9ff;
    color: #fff;
    border-radius: 50%;
    width: 30px; /* Smaller width */
    height: 30px; /* Smaller height */
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 0.9rem; /* Smaller font size */
    cursor: pointer;
    transition: background-color 0.3s;
}

.upload-icon:hover {
    background-color: #4a85cc;
}

.file-input {
    position: absolute;
    z-index: -1;
    opacity: 0;
    width: 0;
    height: 0;
}

</style>
<body>

    <nav class="navbar navbar-expand-sm navbar-dark bg-dark">
        <a href="#" class="navbar-brand mb-0 h1">NEXUS</a> 
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item active dropdown">
                    <a href="#" class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" style="color: #68a9ff;">Users</a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a href="signupintern.html" class="dropdown-item">Intern</a></li>
                        <li><a href="signupcompany.html" class="dropdown-item">Company</a></li>
                        <li><a href="signupschool.html" class="dropdown-item">School</a></li>
                    </ul>
                </li>
                <li class="nav-item active">
                    <a href="#" class="nav-link">About Us</a>
                </li>     
                <li class="nav-item active">
                    <a href="login.html" class="btn btn-custom1 text-white">Login</a>
                </li>
            </ul>
        </div>
    </nav>
    <div id="error-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); color: white; font-size: 18px; justify-content: center; align-items: center; text-align: center; z-index: 1000; display: none;">
        <div id="error-message-container">
            <p id="error-message" style="margin-bottom: 20px; font-size: 1.2em;"></p>
            <button onclick="closeError()" id="close-button">
                Close
            </button>
        </div>
    </div>
<div class="intern-portal-container">
    <p class="intern-portal">Intern Portal <br> | <font style="color: #68a9ff;"> Nexus</p></font>
</div>
<div class="tagline">Bridging the Gap Between Talent and Opportunity</div>


<!--LOGIN CONTAINER-->
<div class="login-container">
    <form class="login-form p-4 rounded shadow-sm" id="internRegisterForm" enctype="multipart/form-data">
        <hr style="margin: auto; align-items: center; width: 100%; color: white; padding-top: 20px;">
        <h4 class="text-center mb-4" id="signupwho">
            Sign up as <span style="color: #68a9ff;">INTERN</span>
        </h4>
        
        <!-- Email -->
        <div class="mb-3">
            <input 
                type="email" 
                name="email" 
                class="form-control" 
                id="email" 
                placeholder="Email" 
                required>
        </div>
    
        <!-- Password -->
        <div class="mb-3">
            <input 
                type="password" 
                name="password" 
                class="form-control" 
                id="password" 
                placeholder="Password" 
                required>
        </div>
    
        <!-- Full Name -->
        <div class="mb-3">
            <input 
                type="text" 
                name="name" 
                class="form-control" 
                id="name" 
                placeholder="Full Name" 
                required>
        </div>
    
        <!-- Address -->
        <div class="mb-3">
            <input 
                type="text" 
                name="address" 
                class="form-control" 
                id="address" 
                placeholder="Address" 
                required>
        </div>
    
        <!-- School ID -->
        <div class="mb-3">
            <input 
                type="text" 
                name="school_id" 
                class="form-control" 
                id="school_id" 
                placeholder="School ID" 
                required>
        </div>
    
        <!-- School ID Image Upload -->
        <div class="mb-3">
            <label for="school_id_image" class="form-label">Upload School ID Image</label>
            <input 
                type="file" 
                name="school_id_image" 
                id="school_id_image" 
                class="form-control" 
                accept="image/*" 
                required>
            <small id="file-name-display" class="text-muted"></small>
        </div>
    
        <!-- Submit Button -->
        <button 
            type="submit" 
            class="btn btn-custom text-white w-100 mt-3">
            Confirm
        </button>
    </form>
    
    <script>
        // Apply styles to the elements via JavaScript
        const overlay = document.getElementById('error-overlay');
        const messageContainer = document.getElementById('error-message-container');
        const closeButton = document.getElementById('close-button');
    
        // Set styles for the overlay
        overlay.style.display = 'none';
        overlay.style.position = 'fixed';
        overlay.style.top = '0';
        overlay.style.left = '0';
        overlay.style.width = '100%';
        overlay.style.height = '100%';
        overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
        overlay.style.color = 'white';
        overlay.style.fontSize = '18px';
        overlay.style.justifyContent = 'center';
        overlay.style.alignItems = 'center';
        overlay.style.textAlign = 'center';
        overlay.style.zIndex = '1000';
    
        // Set styles for the error message container
        messageContainer.style.backgroundColor = '#333';
        messageContainer.style.padding = '30px';
        messageContainer.style.borderRadius = '10px';
        messageContainer.style.maxWidth = '90%';
        messageContainer.style.width = '400px';
        messageContainer.style.boxShadow = '0 4px 10px rgba(0, 0, 0, 0.3)';
        
        // Set styles for the error message
        const message = document.getElementById('error-message');
        message.style.marginBottom = '20px';
        message.style.fontSize = '1.2em';
    
        // Set styles for the close button
        closeButton.style.padding = '12px 25px';
        closeButton.style.backgroundColor = '#68a9ff';
        closeButton.style.color = 'white';
        closeButton.style.border = 'none';
        closeButton.style.borderRadius = '5px';
        closeButton.style.cursor = 'pointer';
        closeButton.style.fontSize = '1.1em';
        closeButton.style.transition = 'background-color 0.3s';
    
        // Set responsive styles
        const mediaQuery = window.matchMedia('(max-width: 600px)');
        function handleResize() {
            if (mediaQuery.matches) {
                messageContainer.style.width = '90%';
                message.style.fontSize = '1em';
                closeButton.style.padding = '10px 20px';
                closeButton.style.fontSize = '1em';
            } else {
                messageContainer.style.width = '400px';
                message.style.fontSize = '1.2em';
                closeButton.style.padding = '12px 25px';
                closeButton.style.fontSize = '1.1em';
            }
        }
        mediaQuery.addListener(handleResize);
        handleResize();  // Initial check on page load
    
        document.getElementById('internRegisterForm').addEventListener('submit', async (event) => {
            event.preventDefault();
    
            const formData = new FormData(event.target); // Collect form data including the file
    
            try {
                const response = await fetch('/register-intern', {
                    method: 'POST',
                    body: formData // No need to set 'Content-Type'; fetch will handle it automatically
                });
    
                if (!response.ok) {
                    const error = await response.json();
                    showError(error.error); // Display server error
                } else {
                    const result = await response.json();
                    alert(result.message); // Show success message
                    location.reload(); // Reload or redirect after success
                }
            } catch (error) {
                console.error('Unexpected error:', error);
                showError('An unexpected error occurred. Please try again later.');
            }
        });
    
        function showError(message) {
            const messageElement = document.getElementById('error-message');
            messageElement.textContent = message;
            overlay.style.display = 'flex';
        }
    
        function closeError() {
            overlay.style.display = 'none';
        }
    
        document.getElementById('school_id_image').addEventListener('change', function () {
            const fileNameDisplay = document.getElementById('file-name-display');
            const fileName = this.files[0] ? this.files[0].name : '';
            if (fileNameDisplay) {
                fileNameDisplay.textContent = fileName; // Display the file name elsewhere
            }
        });
    </script>
    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </body>
    </html>
    